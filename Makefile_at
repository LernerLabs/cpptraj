# CPPTRAJ - AmberTools Makefile
# Daniel R. Roe
# 2010-11-18
# Revised 2016-02-11
include ../config.h

# Create standalone cpptraj binary in ./src/
all: install

install: $(INSTALLTYPE)

cray_serial: serial

cray_parallel: parallel

cray_openmp: openmp

# Create cpptraj/ambpdb binaries within AmberTools
serial:
	cd src && $(MAKE) -f Makefile_at install

# Create OpenMP cpptraj binary within AmberTools
openmp:
	cd src && $(MAKE) -f Makefile_at install_openmp

# Create MPI cpptraj binary within AmberTools
parallel:
	cd src && $(MAKE) -f Makefile_at install_mpi

# Create libcpptraj within AmberTools. Since we do not want to include
# the sander API, delete any objects that may have used it and explicitly
# blank the SANDERAPI_DEF define variable.
libcpptraj:
	/bin/rm -f src/Action_Esander.o src/Cpptraj.o src/Energy_Sander.o
	cd src && $(MAKE) -f Makefile_at libcpptraj SANDERAPI_DEF=""

# Run Tests
check:
	cd test && $(MAKE) test

docs: src/cpptraj.Doxyfile
	cd src && doxygen cpptraj.Doxyfile

# Clean up for AmberTools
clean:
	cd src && $(MAKE) -f Makefile_at clean

# Uninstall for AmberTools 
uninstall:
	cd src && $(MAKE) -f Makefile_at uninstall
